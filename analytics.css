/* ===== Design Tokens ===== */
:root{
  --bg:#f6f7f9; --card:#fff; --card-alt:#fafbfc; --border:#e5e7eb;
  --muted:#6b7280; --text:#0f172a; --shadow:0 6px 20px rgba(2,6,23,.08);
  --maxw: 1200px; /* 更合理的默认最大宽度，避免 2K/4K 时布局过散 */
}

/* ===== Base ===== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans";
  line-height:1.6;
  padding-inline: clamp(12px, 4vw, 24px);
  padding-bottom: 32px;
}

/* ===== Header（修复 sticky 与单位、压缩间距，移动端友好） ===== */
.header-center{
  display:flex; justify-content:center; align-items:center;
  font-size:clamp(18px, 2.3vw, 24px); font-weight:700; letter-spacing:.3px; color:#111827;
}
.site-header{
  position: sticky; top: 0; z-index: 1000;
  background:#f9fafb; color:#111827; border-bottom:1px solid var(--border);
  box-shadow:0 1px 3px rgba(0,0,0,.05);
}
.header-container{
  max-width:var(--maxw); margin:0 auto;
  display:grid; grid-template-columns:auto 1fr auto; align-items:center;
  gap:12px; padding: clamp(8px, 1.8vw, 16px);
}
.header-left{display:flex; align-items:center}
.header-logo{height: clamp(36px, 4.2vw, 46px); width:auto}
.header-center{ text-align:center; font-weight:700; }
.header-right{display:flex; gap: clamp(10px, 2vw, 20px)}
.nav-link{color:#374151; text-decoration:none; font-weight:500; padding-block:6px}
.nav-link:hover{color:#111827}
.nav-link.active{color:#111827; border-bottom:2px solid #111827}
.header-meta{
  max-width:var(--maxw); margin:0 auto;
  padding: 2px clamp(8px, 2vw, 20px) 8px;
  font-size:12px; color:var(--muted); text-align:right;
}

/* ===== 轻量控件（保持 API，视觉统一） ===== */
.controls{
  max-width:var(--maxw); margin: 16px auto 10px;
  background:var(--card); border:1px solid var(--border); border-radius:12px;
  box-shadow:var(--shadow); padding:12px;
}
.wrap{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
.ctrl{display:flex; flex-direction:column; gap:6px; font-size:14px; color:var(--muted)}
.input{
  min-width:min(240px, 100%); background:var(--card-alt); border:1px solid var(--border);
  border-radius:10px; padding:8px 10px; font-size:14px; color:var(--text);
}
.btn{
  padding:8px 14px; border-radius:10px; border:1px solid #d1d5db; background:#fff; cursor:pointer
}
.btn:hover{background:#f3f4f6}
.btn-primary{border-color:#2563eb; background:#2563eb; color:#fff}
.btn-primary:hover{filter:brightness(.98)}

/* ===== Filters（与 index 对齐） ===== */
#filters{
  max-width:var(--maxw); margin:16px auto; background:var(--card); border:1px solid var(--border);
  border-radius:14px; box-shadow:var(--shadow);
  display:flex; flex-wrap:wrap; gap:16px 24px; padding:14px; align-items:flex-start;
}
#filters label{
  display:flex; flex-direction:column; gap:6px;
  min-width:220px; flex:1 1 260px; color:var(--muted); font-size:14px;
}
#filters select,
#filters input,
#filters .ms-toggle{
  background:var(--card-alt); border:1px solid var(--border);
  border-radius:10px; padding:8px 10px; min-height:36px; font-size:14px; color:var(--text);
}
#filters .btn-group{flex-basis:100%; display:flex; gap:12px; margin-top:4px}
#filters .btn-group button{
  padding:8px 16px; border-radius:10px; font-size:14px; font-weight:600; cursor:pointer;
  border:1px solid #2563eb; background:#2563eb; color:#fff;
}

/* ===== 自定义多选 ===== */
.ms-field{display:inline-flex; flex-direction:column; gap:6px}
.ms{position:relative; display:inline-block; width:100%; max-width:320px}
.ms-toggle{
  display:inline-flex; align-items:center; justify-content:space-between; gap:6px;
  padding:8px 10px; width:100%; background:var(--card-alt);
  border:1px solid var(--border); border-radius:10px; cursor:pointer;
}
.ms-caret{opacity:.7}
.ms-panel{
  position:absolute; z-index:60; top:calc(100% + 6px); left:0;
  min-width:260px; width:max(260px,100%); max-width:420px;
  background:#fff; border:1px solid var(--border); border-radius:12px;
  box-shadow:0 10px 24px rgba(2,6,23,.12); padding:10px;
}
.ms-head{display:flex; align-items:center; gap:6px; font-size:12px; margin-bottom:8px}
.ms-head a{color:#2563eb; text-decoration:none}
.ms-head a:hover{text-decoration:underline}
.ms-count{margin-left:auto; color:#6b7280}
.ms-search{position:relative; margin-bottom:8px}
.ms-input{width:100%; padding:8px 30px 8px 10px; border:1px solid var(--border); border-radius:8px}
.ms-icon{position:absolute; right:8px; top:50%; transform:translateY(-50%); opacity:.7}
.ms-list{max-height:260px; overflow:auto; padding-right:4px}
.ms-item{display:flex !important; flex-direction:row !important; align-items:center; gap:8px; padding:6px 4px}
.ms-empty{color:#9ca3af; font-size:12px; padding:8px 4px}
#filters .ms-panel .ms-item input[type="checkbox"]{margin:0; flex:0 0 auto}
#filters .ms-panel .ms-item .ms-label{flex:1 1 auto; white-space:nowrap}

/* ===== 主体布局 ===== */
.grid-2{
  max-width:var(--maxw); margin:8px auto 0;
  display:grid; grid-template-columns: minmax(260px, 420px) 1fr;
  gap:16px;
}
.panel{
  background:var(--card); border:1px solid var(--border); border-radius:12px; padding:12px; box-shadow:var(--shadow);
}
.panel-title{margin:4px 0 10px; font-size:16px; color:#111827}
.panel-subtitle{margin:12px 0 8px; font-size:14px; color:#111827}
.hint{color:#9ca3af; font-size:12px}

/* ===== KPI 汇总 ===== */
.kpis{list-style:none; margin:0; padding:0; display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:10px}
.kpis .k{display:block; font-size:12px; color:var(--muted)}
.kpis .v{display:block; font-size:16px; font-weight:600; color:#111827}
.empty{padding:10px; background:#fafafa; border:1px dashed #e5e7eb; border-radius:8px; color:#6b7280}

/* ===== 表格 ===== */
.table-wrap{overflow:auto; border-radius:8px; border:1px solid var(--border)}
.table{width:100%; border-collapse:collapse; font-size:13px}
.table thead th{
  background:#f3f4f6; color:#6b7280; text-align:center; font-weight:600;
  padding:10px; position:sticky; top:0;
}
.table td{border-top:1px solid var(--border); padding:10px; text-align:center}
.table tbody tr:nth-child(even){background:#fafbfc}

/* ===== 行配色（保持兼容） ===== */
tbody tr.days-purple{background:#8b5cf622; box-shadow:inset 4px 0 0 0 #8b5cf6}
tbody tr.days-red-strong{background:#ef444422; box-shadow:inset 4px 0 0 0 #ef4444}
tbody tr.days-pink{background:#f472b622; box-shadow:inset 4px 0 0 0 #f472b6}
tbody tr.days-orange{background:#f59e0b22; box-shadow:inset 4px 0 0 0 #f59e0b}
tbody tr.days-green{background:#10b98122; box-shadow:inset 4px 0 0 0 #10b981}

/* ===== Toast ===== */
.toast{
  position:fixed; right: clamp(12px, 3vw, 24px); bottom: clamp(12px, 3vw, 24px); z-index:9999;
  background:rgba(17,24,39,.9); color:#fff; padding:10px 14px; border-radius:8px; font-size:13px;
  transition:opacity .3s ease;
}
.toast.hide{opacity:0}

/* ===== Footer（固定底部，留出内容空间） ===== */
.footer{
  background:#f3f4f6; border-top:1px solid var(--border); color:#000; text-align:center;
  padding:16px 20px; font-size:13px;
  position:fixed; left:0; right:0; bottom:0; z-index:1000;
}
.footer .logo{height:40px; width:auto; margin-bottom:4px}
.footer-copy{font-size:12px; color:#555}

/* ===== 两列排版（图表 + 概要） ===== */
.panel-row.two-col{display:grid; grid-template-columns: 4fr 6fr; gap:16px; align-items:start}
@media (max-width: 992px){ .panel-row.two-col{grid-template-columns:1fr} }
#chartPanel canvas#pie{width:100%; height:auto; display:block}
.summary .kpis{display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:8px 12px; padding:4px 0}
.summary .kpis .k{font-size:12px; color:var(--muted); margin-right:6px}
.summary .kpis .v{font-weight:600}
.summary .empty,.summary .tip{padding:8px 10px; background:#f9fafb; border:1px solid #eee; border-radius:10px}
.panel{align-self:start}

/* ===== 响应式 ===== */
@media (max-width: 900px){ .grid-2{grid-template-columns:1fr} }

/* ===== 辅助 ===== */
.container{max-width:var(--maxw); margin:0 auto; padding:0 20px}
.site-header .header-container{padding: clamp(6px, 1.5vw, 12px) 20px}
.site-header .brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:inherit}
.site-header .site-title,.header-center{font-size:28px; font-weight:700; letter-spacing:.3px; color:#111827; margin:0}
.site-header .site-nav,.header-right{display:flex; gap:16px; align-items:center}
.site-header .site-nav a,.nav-link{
  color:#374151; text-decoration:none; font-weight:500; padding:8px 6px; border-bottom:2px solid transparent
}
.site-header .site-nav a:hover,.nav-link:hover{color:#111827}
.site-header .site-nav a[aria-current="page"],.nav-link.active{color:#111827; border-bottom-color:#111827}
.header-left .header-logo{height: clamp(40px, 5vw, 60px)}
