<!DOCTYPE html>

<html lang="zh">
<head>
<meta charset="utf-8"/>
<title>Route Analysis</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<!-- 站点样式（和 index 对齐的头部/底部样式） -->
<link href="style.css" rel="stylesheet"/>
<!-- 分析页样式（含筛选器、多选 ms、表格配色等） -->
<link href="analytics.css" rel="stylesheet"/>
<!-- PapaParse / Chart.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
</head>
<body data-mode="route"><!-- 当前页按“线路维度”默认渲染司机分布饼图 -->
<header class="site-header"><div class="header-container"><div class="header-left"><a class="brand" href="index.html"><img alt="Logo" class="header-logo" src="logo.png"/></a></div><div class="header-center"> 🔍 Tracking System -- Route Analysis</div><nav class="header-right"><a class="nav-link" href="index.html"> 📦 Order List</a><a class="nav-link" href="drivers_analytics.html"> 🚚 Driver Analysis</a><a aria-current="page" class="nav-link   a c t i v e" href="routes_analytics.html"> 🔍 Route Analysis</a></nav></div><div class="header-meta"><div id="refresh-info">更新于: --</div></div></header>
<!-- === 统一的筛选器区（仅一份） === -->
<section class="container" id="filters">
<label>
      Warehouse:
      <select id="warehouseSelect"><option value="">ALL</option></select>
</label>
<!-- DSP 多选 -->
<label class="ms-field">
      DSP:
      <select id="dspSelect" style="display:none"><option value="">全部</option></select>
<div class="ms" id="dspMS">
<button class="ms-toggle" type="button">全部
          <svg aria-hidden="true" class="ms-caret" height="14" viewbox="0 0 20 20" width="14"><path d="M5 7l5 6 5-6" fill="currentColor"></path></svg>
</button>
<div class="ms-panel" hidden="">
<div class="ms-head">
<a data-act="selectAll" href="#">Select all</a><span> - </span>
<a data-act="clear" href="#">Clear</a>
<span class="ms-count">Displaying 0</span>
</div>
<div class="ms-search">
<input class="ms-input" placeholder="Search..." type="text"/>
<svg aria-hidden="true" class="ms-icon" height="16" viewbox="0 0 24 24" width="16"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.49 21.49 20l-5.99-6zM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="currentColor"></path></svg>
</div>
<div class="ms-list"></div>
</div>
</div>
</label>
<!-- 线路 多选 -->
<label class="ms-field">
      Route:
      <select id="routeSelect" style="display:none"><option value="">ALL</option></select>
<div class="ms" id="routeMS">
<button class="ms-toggle" type="button">全部
          <svg aria-hidden="true" class="ms-caret" height="14" viewbox="0 0 20 20" width="14"><path d="M5 7l5 6 5-6" fill="currentColor"></path></svg>
</button>
<div class="ms-panel" hidden="">
<div class="ms-head">
<a data-act="selectAll" href="#">Select all</a><span> - </span>
<a data-act="clear" href="#">Clear</a>
<span class="ms-count">Displaying 0</span>
</div>
<div class="ms-search">
<input class="ms-input" placeholder="Search..." type="text"/>
<svg aria-hidden="true" class="ms-icon" height="16" viewbox="0 0 24 24" width="16"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.49 21.49 20l-5.99-6zM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="currentColor"></path></svg>
</div>
<div class="ms-list"></div>
</div>
</div>
</label>
<!-- 状态码 多选 -->
<label class="ms-field">
      Latest Status:
      <select id="statusSelect" style="display:none"><option value="">ALL</option></select>
<div class="ms" id="statusMS">
<button class="ms-toggle" type="button">ALL
          <svg aria-hidden="true" class="ms-caret" height="14" viewbox="0 0 20 20" width="14"><path d="M5 7l5 6 5-6" fill="currentColor"></path></svg>
</button>
<div class="ms-panel" hidden="">
<div class="ms-head">
<a data-act="selectAll" href="#">Select all</a><span> - </span>
<a data-act="clear" href="#">Clear</a>
<span class="ms-count">Displaying 0</span>
</div>
<div class="ms-search">
<input class="ms-input" placeholder="Search..." type="text"/>
<svg aria-hidden="true" class="ms-icon" height="16" viewbox="0 0 24 24" width="16"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 21.49 21.49 20l-5.99-6zM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="currentColor"></path></svg>
</div>
<div class="ms-list"></div>
</div>
</div>
</label>
<label>
      Driver id:
      <input id="driverInput" placeholder="Enter driver id"/>
</label>
<!-- 天数差 多选（固定档位） -->
<label class="ms-field">
      #Days since last update:
      <select id="daysBucketSelect" style="display:none">
<option value="all">ALL</option>
<option value="&lt;0">Less than 0 days (discontinued)</option>
<option value="&lt;1">Less than 1 day</option>
<option value="1">1 day</option>
<option value="2">2 days</option>
<option value="3">3 days</option>
</select>
<div class="ms" id="daysMS">
<button class="ms-toggle" type="button">ALL
          <svg aria-hidden="true" class="ms-caret" height="14" viewbox="0 0 20 20" width="14">
<path d="M5 7l5 6 5-6" fill="currentColor"></path>
</svg>
</button>
<div class="ms-panel" hidden="">
<div class="ms-head">
<a data-act="selectAll" href="#">Select all</a><span> - </span>
<a data-act="clear" href="#">Clear</a>
<span class="ms-count">Displaying 0</span>
</div>
<div class="ms-search">
<input class="ms-input" placeholder="Search..." type="text">
<svg aria-hidden="true" class="ms-icon" height="16" viewbox="0 0 24 24" width="16">
<path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 
                6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79L20 
                21.49 21.49 20l-5.99-6zM9.5 14C7.01 14 5 11.99 5 
                9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="currentColor"></path>
</svg>
</input></div>
<div class="ms-list"></div>
</div>
</div>
</label>
<!-- 第二排按钮 -->
<div class="btn-group">
<button id="refreshBtn">Refresh</button>
<button id="copyOrdersBtn" title="复制当前页面可见行的单号">Copy</button>
</div>
</section>
<main class="container">
<!-- 左 70%：饼图 | 右 30%：概要（上）+ 明细（下） -->
<div class="panel-row two-col two-col-side">
<!-- 左列：饼图 -->
<section class="panel" id="chartPanel">
<h2 class="panel-title" id="chartTitle">Route Distribution</h2>

<canvas height="320" id="pie"></canvas>
</section>
<!-- 右列：概要（上）+ 明细（下） -->
<div class="side-col">
<section class="panel" id="summaryPanel">
<h2 class="panel-title">Summary</h2>
<div class="summary" id="summary"></div>
</section>
<section class="panel" id="detailPanel">
<h2 class="panel-title">Details</h2>
<div class="table-wrap">
<table class="data-table">
<thead>
<tr>
<th>Tracking</th>
<th>Warehouse</th>
<th>DSP</th>
<th>Driver id</th>
<th># Route</th>
<th>Latest Status</th>
<th>Latest Update Time</th>
<th>#Days since last update</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>
</section>
</div>
</div>
</main>

<script src="routes_analytics.js"></script>
</body>
</html>
